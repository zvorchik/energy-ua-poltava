
# EnergyUA Schedule (HACS Integration)

Интеграция Home Assistant для парсинга графика отключений с сайта Energy-UA и вычисления:
- текущего состояния света (есть/нет → `on/off`),
- таймера до ближайшего изменения (формат `HH:MM`, без секунд),
- минут до ближайшего изменения,
- типа следующего изменения (`off` — отключение, `on` — включение),
- бинарного претриггера «ровно за N минут до изменения».

## Возможности
- Настройка **через UI** (Config Flow): URL страницы очереди (по умолчанию `https://energy-ua.info/cherga/3-1`), период обновления, и N минут для претриггера.
- Корректная обработка интервалов, пересекающих полночь.
- Использует локальное время Home Assistant.

## Установка (через HACS)
1. В HACS → **Integrations** → кликните `⋮` → **Custom repositories**.
2. Добавьте кастомный репозиторий (тип **Integration**): URL вашего репо, куда вы положите содержимое этого архива.
3. Найдите **EnergyUA Schedule** в списке интеграций HACS и установите.
4. В Home Assistant: **Settings → Devices & Services → Add Integration** → найдите **EnergyUA Schedule** и добавьте.

## Настройка
- **URL очереди**: например, `https://energy-ua.info/cherga/3-1` (замените на вашу чергу/підгрупу).
- **Интервал обновления**: каждые X минут (по умолчанию 15).
- **Минуты для претриггера**: N минут до изменения (по умолчанию 10).

## Создаваемые сущности
- `sensor.energyua_minutes_until_next_change` — целое число минут до ближайшего изменения.
  - атрибут `countdown_hm` — таймер `HH:MM` (без секунд).
  - атрибут `next_change_type` — `off` (отключение) / `on` (включение).
  - атрибут `periods` — список интервалов на текущую дату.
- `sensor.energyua_countdown_hm` — строка `HH:MM` (дублирует атрибут, удобно для UI).
- `binary_sensor.energyua_power_state_now` — есть свет сейчас? (`on`/`off`).
- `binary_sensor.energyua_pretrigger` — претриггер «ровно за N минут до изменения» (`on`/`off`).

## Лицензия
MIT.
